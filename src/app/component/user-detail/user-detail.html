<div class="container mx-auto p-4 max-w-4xl">
  @if (isLoading()) {
    <div class="flex justify-center items-center min-h-[400px]">
      <span class="loading loading-spinner loading-xl"></span>
    </div>
  } @else if (errorMessage()) {
    <div role="alert" class="alert alert-error">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <span>{{ errorMessage() }}</span>
      <button class="btn btn-sm" (click)="goBack()">Go Back</button>
    </div>
  } @else if (user()) {
    <!-- User Profile Card -->
    <div class="card bg-base-100 shadow-xl mb-6">
      <div class="card-body">
        <button class="btn btn-ghost btn-sm self-start mb-4" (click)="goBack()">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="m15 18-6-6 6-6"/>
          </svg>
          Back to Users
        </button>

        <div class="flex items-start gap-6">
          <div class="avatar">
            <div class="w-24 rounded-full">
              <img [src]="user()?.profile?.avatar || 'https://api.dicebear.com/7.x/avataaars/svg?seed=' + user()?.username" 
                   [alt]="user()?.username" />
            </div>
          </div>
          
          <div class="flex-1">
            <h1 class="card-title text-3xl mb-2">{{ user()?.username }}</h1>
            <p class="text-base-content/70 mb-2">{{ user()?.email }}</p>
            
            @if (user()?.profile?.bio) {
              <div class="mt-4">
                <h3 class="font-semibold mb-2">Bio</h3>
                <p class="text-base-content/80">{{ user()?.profile?.bio }}</p>
              </div>
            }
          </div>
        </div>

        <div class="stats stats-vertical lg:stats-horizontal shadow mt-6">
          <div class="stat">
            <div class="stat-title">Total Posts</div>
            <div class="stat-value text-primary">{{ user()?.posts?.length || 0 }}</div>
          </div>
        </div>
      </div>
    </div>

    <!-- User Posts Section -->
    <div class="mb-4">
      <h2 class="text-2xl font-bold mb-4">Posts by {{ user()?.username }}</h2>
      
      @if (user()?.posts && user()!.posts.length > 0) {
        <div class="space-y-4">
          @for (post of user()?.posts; track post.id) {
            <div class="card bg-base-100 shadow-xl">
              <div class="card-body">
                <h3 class="card-title">{{ post.title }}</h3>
                <p class="text-base-content/80">{{ post.content }}</p>
                
                <div class="flex gap-2 flex-wrap mt-2">
                  @for (tag of post.tags; track tag.id) {
                    <span class="badge badge-primary badge-outline">#{{ tag.name }}</span>
                  }
                </div>
              </div>
            </div>
          }
        </div>
      } @else {
        <div class="alert">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <span>This user hasn't posted anything yet.</span>
        </div>
      }
    </div>
  }
</div>
